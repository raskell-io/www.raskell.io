<!doctype html><html lang=en><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content=dark name=theme-color><title>Disk space maintenance on Void Linux | Raskell</title><link href=https://raskell.io/rss.xml rel=alternate title=RSS type=application/rss+xml><meta content="Raskell | Tech web space curated by Raffael" property=og:site_name><meta content="Disk space maintenance on Void Linux | Raskell" property=og:title><meta content="Disk space maintenance on Void Linux | Raskell" itemprop=name><meta content="Disk space maintenance on Void Linux | Raskell" name=twitter:title><meta content="Disk space maintenance on Void Linux | Raskell" name=application-name><meta content=summary name=twitter:card><meta content="What to do when disk space is full after not paying attention after many months if not years of using Void Linux." name=description><meta content="What to do when disk space is full after not paying attention after many months if not years of using Void Linux." name=twitter:description><meta content="What to do when disk space is full after not paying attention after many months if not years of using Void Linux." itemprop=description><meta content="What to do when disk space is full after not paying attention after many months if not years of using Void Linux." property=og:description><meta content=article property=og:type><meta content=Raffael property=article:author><meta content=2024-05-01 property=article:published_time><link rel="shortcut icon" href=https://raskell.io/raskell-mascot.avif type=image/x-icon><link href=https://raskell.io/style.css rel=stylesheet><script>(()=>{const a=`ThemeColorScheme`;const b=`auto`;if(!localStorage.getItem(a)){localStorage.setItem(a,b)}})()</script><script>(()=>{let d=`dark`;const a=`ThemeColorScheme`;const b=localStorage.getItem(a);const c=window.matchMedia(`(prefers-color-scheme: dark)`).matches===!0;if(b==d||b===`auto`&&c){document.documentElement.dataset.userColorScheme=d}else{document.documentElement.dataset.userColorScheme=`light`}})()</script><body class=dark><nav class=navbar><div class=container><div class=flex><div><a class=brand href=https://raskell.io> <img alt="Raskell logo" class=brand-logo src=https://raskell.io/raskell-mascot.avif> <span class=brand-text>Raskell</span> </a></div><div class=flex><a href=https://raskell.io/articles/>Articles</a><a href=https://raskell.io/projects/>Projects</a><a href=https://raskell.io/speaking/>Speaking</a><a href=https://raskell.io/about/>About</a><button aria-label="Toggle theme" title="Toggle light/dark theme" id=dark-mode-button><div class=theme-toggle-inner><svg viewbox="0 0 24 24" class=sun-icon fill=none height=20 stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 width=20><circle cx=12 cy=12 r=5></circle><line x1=12 x2=12 y1=1 y2=3></line><line x1=12 x2=12 y1=21 y2=23></line><line x1=4.22 x2=5.64 y1=4.22 y2=5.64></line><line x1=18.36 x2=19.78 y1=18.36 y2=19.78></line><line x1=1 x2=3 y1=12 y2=12></line><line x1=21 x2=23 y1=12 y2=12></line><line x1=4.22 x2=5.64 y1=19.78 y2=18.36></line><line x1=18.36 x2=19.78 y1=5.64 y2=4.22></line></svg><svg viewbox="0 0 24 24" class=moon-icon fill=none height=20 stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 width=20><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></div></button></div></div></div></nav><main><div class=container><article><header class=article-header><div class=thumb><div><h1>Disk space maintenance on Void Linux</h1><div class=post-meta><div class=meta-line><span class=author>Raffael</span><span class=separator>·</span><time>May 01, 2024</time><span class=separator>·</span><span class=reading-time>3 min read</span></div></div></div></div><img alt="Disk space maintenance on Void Linux" class=post-thumbnail decoding=async loading=lazy src=/void-disk-usage.avif></header></article><div class=article-post><h2 id=monday-morning-surprise>Monday morning surprise</h2><p>As I spent most time doing stuff with my computer rather than configuring my beloved Linux distribution, Void Linux, I have developed the tendency to not really bother about Void at all until something crucial becomes unusable. After almost two years of having switched from Arch to Void, I have actually never encountered any major problem and felt I had made the right decision.<p>I checked my disk usage out of curiosity if the 250GB solid-state disk would be enough. And there came the surprise:<pre class=language-shell data-lang=shell style=color:#d8dee9;background-color:#2e3440><code class=language-shell data-lang=shell><span>$ df -H
</span><span>Filesystem      Size  Used Avail Use% Mounted on
</span><span>devtmpfs        8.4G     0  8.4G   0% /dev
</span><span>tmpfs           8.4G  1.9M  8.4G   1% /dev/shm
</span><span>tmpfs           8.4G  1.4M  8.4G   1% /run
</span><span>/dev/nvme0n1p3  138G  117G   21G  85% /
</span><span>efivarfs        158k   85k   69k  56% /sys/firmware/efi/efivars
</span><span>cgroup          8.4G     0  8.4G   0% /sys/fs/cgroup
</span><span>/dev/nvme0n1p4  366G   34G  332G  10% /home
</span><span>/dev/nvme0n1p1  536M  152k  536M   1% /boot/efi
</span><span>tmpfs           8.4G   25k  8.4G   1% /tmp
</span></code></pre><p>My root partition was full, way too full in my opinion. Did I miss something? Is Void not what I was looking for after all? I don’t enjoy baby sitting my OS <em>du jour</em>.<h2 id=the-painless-solution>The painless solution</h2><p>After a quick Brave search, I ended up finding what I was looking for. Some kind fellow software engineer from China didn’t shy away to make a blog post about his journey when he faced the very same problem. Out of annoyance of having to deal with that, I copy-pasted as quickly as possible, not minding what kind of side-effects I might run into, these three commands.<h3 id=1-cleaning-the-package-cache>1. Cleaning the package cache</h3><p>All the knowledge I was lacking was to be found with the man page of <code>xbps-remove</code>.<pre class=language-shell data-lang=shell style=color:#d8dee9;background-color:#2e3440><code class=language-shell data-lang=shell><span># xbps-remove -yO
</span></code></pre><p>The <a href=https://man.voidlinux.org/xbps-remove.1#O, rel=noopener target=_blank>man page</a> of <code>xbps-remove</code> tells us the <code>-O</code> parameter takes care of <em>cleaning the cache directory removing obsolete binary packages.</em> Obsolete binary packages? Good riddance! I was surprised this to learn that solely this step freed up almost half of my used root partition disk space.<h3 id=2-removing-orphaned-packages>2. Removing orphaned packages</h3><pre class=language-shell data-lang=shell style=color:#d8dee9;background-color:#2e3440><code class=language-shell data-lang=shell><span># xbps-remove -yo
</span></code></pre><p>Here the same <a href=https://man.voidlinux.org/xbps-remove.1#o, rel=noopener target=_blank>man page</a> tells us that the <code>-o</code> parameter takes care of <em>removing installed package orphans that were installed automatically (as dependencies) and are not currently dependencies of any installed package.</em> As before, good riddance!<h3 id=3-purging-old-unused-kernels>3. Purging old, unused kernels</h3><p>This one is interesting. While I knew about the circumstance that the people behind Void had developed their own package management ecosystem, I hadn’t fully realized there were other utilities that came along with the upstream Void installation which were there for me to manage my beloved OS. So, apparently, one of these is a <a href=https://github.com/void-linux/void-packages/blob/master/srcpkgs/base-files/files/vkpurge rel=noopener target=_blank>shell script</a> name <code>vkpurge</code>, I must assume as a short name for <code>Void's Kernel purging</code> tool. I like this type of naming heavily implying its functionality.<pre class=language-shell data-lang=shell style=color:#d8dee9;background-color:#2e3440><code class=language-shell data-lang=shell><span># vkpurge rm all
</span></code></pre><p>It performed as expected. Old kernel files (and modules?) were indeed purged and freed up even more disk space. I should add that this step is optional as it is always useful to have some old kernels at hand when things hit the fan (which for me, they haven’t in a very, very long time).<h2 id=result>Result</h2><p>I couldn’t be happier.<pre class=language-shell data-lang=shell style=color:#d8dee9;background-color:#2e3440><code class=language-shell data-lang=shell><span>$ df -H
</span><span>Filesystem      Size  Used Avail Use% Mounted on
</span><span>...
</span><span>/dev/nvme0n1p3  138G   45G   93G  33% /
</span><span>...
</span></code></pre><h2 id=renewal-of-faith>Renewal of faith</h2><p>Overall, why am I even writing this if some other fellow engineer already figured this out? Simply, because I would therefore be able to explain why I have enjoyed my journey with Void as my go-to Linux distribution. It keeps things simple. Some well-documented utilities. As simple that a simple Brave search suffices to find the answer to my problems.<p>This very aspect of Void is worthwhile highlighing. I remember more arcane Linux distributions that had me in their grip in figuring things out. Many Googles searches were necessary and even more trial and errors attempts to get simple things fixed.<p>Now back to my Monday morning.<hr><div class=footnote-definition id=1><sup class=footnote-definition-label>1</sup><p>Painting in header image is “Seaside” by Aleksandr Deyneka</div></div></div><div class=container><nav class="flex container suggested"><a title="Previous post (older)" href=https://raskell.io/articles/mise-ate-my-makefile/ rel=prev> <span>← Previous</span> <strong>Mise ate my Makefile</strong> </a><a title="Next post (newer)" href=https://raskell.io/articles/all-beginning-is-haskell/ rel=next> <span>Next →</span> <strong>All beginning is Haskell</strong> </a></nav></div></main><footer class="footer flex"><section class=container><nav class=footer-links><a href=https://raskell.io/rss.xml>RSS</a></nav></section><script src=https://raskell.io/app.js></script></footer><script src=https://raskell.io/anchors.js></script><script src=https://raskell.io/scroll-to-top.js></script>